!function r(e,t,n){function u(o,a){if(!t[o]){if(!e[o]){var s="function"==typeof require&&require;if(!a&&s)return s(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var c=t[o]={exports:{}};e[o][0].call(c.exports,function(r){var t=e[o][1][r];return u(t?t:r)},c,c.exports,r,e,t,n)}return t[o].exports}for(var i="function"==typeof require&&require,o=0;o<n.length;o++)u(n[o]);return u}({1:[function(r,e,t){"use strict";function n(r){return 1===p.size(r)&&p.keys(r)[0]in $}function u(r,e){if(n(e)){var t=p.keys(e)[0],u=e[t],i=$[t],o=i(r,u);return o}}function i(r,e){return 1===e?p.size(r):p.sum(r,function(r){return d.$expression(r,e)})}function o(r,e){return i(r,e)/p.size(r)}function a(r,e){return d.$expression(p.first(r),e)}function s(r,e){return d.$expression(p.last(r),e)}function f(r,e){return p.max(r,function(r){return d.$expression(r,e)})}function c(r,e){return p.min(r,function(r){return d.$expression(r,e)})}function l(r,e){return p.map(r,function(r){return d.$expression(r,e)})}function g(r,e){return console.debug("Please find a more efficient way to do this"),p.unique(l(r,e),function(r){return JSON.stringify(r)})}Object.defineProperty(t,"__esModule",{value:!0});var p=r("lodash"),d=r("./expressions"),$={$accumulate:u,$sum:i,$avg:o,$first:a,$last:s,$min:c,$max:f,$push:l,$addToSet:g};t["default"]=$,t.$accumulate=u},{"./expressions":4,lodash:void 0}],2:[function(r,e,t){"use strict";function n(r,e){return"_id"in e||(e._id=1),o.chain(r).map(function(r){return a.$expressionObject(r,e,r)})}function u(r){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],t=e._id,n=o.chain(r).groupBy(function(r){return t?JSON.stringify(a.$expression(r,t)):null});return n.map(function(r,n,u){return o.mapValues(e,function(e,n){return"_id"===n?e?a.$expression(r[0],t):null:s.$accumulate(r,e)})})}function i(r,e){o.isArray(e)||(e=[e]),r=o.chain(r);for(var t=0;t<e.length;t++){var i=e[t];i.$project&&(r=n(r,i.$project)),i.$group&&(r=u(r,i.$group))}return r.value()}Object.defineProperty(t,"__esModule",{value:!0});var o=r("lodash"),a=r("./expressions"),s=r("./accumulators");t["default"]={aggregate:i,$project:n,$group:u},e.exports=t["default"]},{"./accumulators":1,"./expressions":4,lodash:void 0}],3:[function(r,e,t){"use strict";function n(r){return u.size(r)}Object.defineProperty(t,"__esModule",{value:!0});var u=r("lodash");t["default"]={count:n},e.exports=t["default"]},{lodash:void 0}],4:[function(r,e,t){"use strict";function n(r){return r&&r.__esModule?r:{"default":r}}function u(r){if(Array.isArray(r)){for(var e=0,t=Array(r.length);e<r.length;e++)t[e]=r[e];return t}return Array.from(r)}function i(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function o(r){return"string"==typeof r&&0===r.indexOf("$")&&-1===r.indexOf("$$")}function a(r){return"string"==typeof r&&0===r.indexOf("$$")}function s(r){return y.isObject(r)&&!f(r)&&!y.isArray(r)&&!y.isDate(r)}function f(r){return 1===y.size(r)&&y.keys(r)[0]in v["default"]}function c(r,e,t){var n;return void 0===t&&(t=r),n=a(e)?d(r,e,t):f(e)?g(t,e,t):o(e)?l(r,e):s(e)?p(r,e,t):e}function l(r,e){return e=e.slice(1),y.get(r,e)}function g(r,e,t){var n,i=y.keys(e)[0],o=e[i],a=v["default"][i];return y.isArray(o)||(o=[o]),o=o.map(function(e){return c(r,e,t)}),n=a.apply(void 0,u(o))}function p(r,e,t){var n={};void 0===t&&(t=r);var u=function(u){var o=t,s=e[u];if(-1!==u.indexOf(".")){a=u.split(".");var f=a.shift(),l=y.get(r,f);y.isArray(l)?y.set(n,f,l.map(function(r){return c(r,i({},a.join("."),s),t)})):y.merge(n,y.set({},f,c(l,i({},a.join("."),s),t)))}else{if(s===!0||1===s)o=r,s="$"+u;else{if(s===!1||0===s)return"continue";"string"==typeof s?o=t:"object"==typeof s&&(o=y.get(r,u))}y.isArray(o)?y.merge(n,y.set({},u,o.map(function(r){return c(r,s,t)}))):y.merge(n,y.set({},u,c(o,s,t)))}};for(var o in e)var a,s=u(o);return n}function d(r,e,t){switch(e){case"$$ROOT":return t;case"$$CURRENT":return r}throw Error("Unsupported system variable")}function $(){}Object.defineProperty(t,"__esModule",{value:!0});var y=r("lodash"),m=r("./operators"),v=n(m);t["default"]={$expression:c,$fieldPath:l,$systemVariable:d,$literal:$,$expressionObject:p,isExpressionOperator:f,isExpressionObject:s},e.exports=t["default"]},{"./operators":5,lodash:void 0}],5:[function(r,e,t){"use strict";function n(r){if(Array.isArray(r)){for(var e=0,t=Array(r.length);e<r.length;e++)t[e]=r[e];return t}return Array.from(r)}function u(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return J.every(e)}function i(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return J.some(e)}function o(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return!J.some(e)}function a(r){return J.unique(r).sort($)}function s(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];var n=e.map(a),u=n.shift();return J.every(n,J.partial(J.isEqual,u))}function f(){return a(J.intersection.apply(void 0,arguments))}function c(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return J.union.apply(void 0,n(e.map(a)))}function l(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return J.difference.apply(void 0,n(e.map(a)))}function g(r,e){return J.isEqual(a(J.intersection(r,e)),a(r))}function p(r){if(!J.isArray(r))throw Error("values must be an array, got "+typeof r);return i.apply(void 0,n(r))}function d(r){if(!J.isArray(r))throw Error("values must be an array, got "+typeof r);return u.apply(void 0,n(r))}function $(r,e){return J.isArray(r)&&J.isArray(e)?0:h(r,e)?-1:m(r,e)?1:0}function y(r,e){return J.isEqual(r,e)}function m(r,e){return J.isArray(e)&&!J.isArray(r)?!1:J.isArray(r)&&!J.isArray(e)?!0:J.gt(r,e)}function v(r,e){return J.isArray(e)&&!J.isArray(r)?!1:J.isArray(r)&&!J.isArray(e)?!0:J.gte(r,e)}function h(r,e){return J.isArray(e)&&!J.isArray(r)?!0:J.isArray(r)&&!J.isArray(e)?!1:J.lt(r,e)}function A(r,e){return J.isArray(e)&&!J.isArray(r)?!0:J.isArray(r)&&!J.isArray(e)?!1:J.lte(r,e)}function x(r,e){return!y(r,e)}function O(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];var n=e.shift(),u=!1;J.isDate(n)&&(u=!0,n=n.getTime());for(var i=e.length-1;i>=0;i--){var o=e[i];J.isDate(o)&&(u=!0,o=o.getTime()),n+=o}return u?new Date(n):n}function b(r,e){return J.isDate(r)&&J.isDate(e)?r.getTime()-e.getTime():J.isDate(r)&&!J.isDate(e)?new Date(r.getTime()-e):!J.isDate(r)&&J.isDate(e)?new Date(r-e.getTime()):r-e}function w(r,e){return r*e}function D(r,e){return r/e}function j(r,e){return r%e}function _(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return e.join("")}function E(r,e,t){return r.slice(e,e+t)}function M(r){return r.toLowerCase()}function T(r){return r.toUpperCase()}function q(r,e){if(r=r.toLowerCase(),e=e.toLowerCase(),r===e)return 0;if(r>e)return 1;if(e>r)return-1;throw new Error("Error comparing values: "+r+" and "+e)}function P(r){throw new Error("Not Implemented")}function S(r){var e=new Date(r.getFullYear(),0,0),t=r-e,n=864e5,u=Math.floor(t/n);return u}function U(r){return r?r.getDate():null}function k(r){return r?r.getDay():null}function C(r){return r?r.getFullYear():null}function N(r){return r?r.getMonth()+1:null}function z(r){var e=new Date(r.valueOf()),t=(r.getDay()+6)%7;e.setDate(e.getDate()-t+3);var n=new Date(e.getFullYear(),0,4),u=(e-n)/864e5,i=1+Math.ceil(u/7);return i}function L(r){return r.getHours()}function F(r){return r.getMinutes()}function Y(r){return r.getSeconds()}function I(r){return r.getMilliseconds()}function R(r){return r.toString()}Object.defineProperty(t,"__esModule",{value:!0});var J=r("lodash");t["default"]={$and:u,$or:i,$not:o,$setEquals:s,$setIntersection:f,$setUnion:c,$setDifference:l,$setIsSubset:g,$anyElementTrue:p,$allElementsTrue:d,$cmp:$,$eq:y,$gt:m,$gte:v,$lt:h,$lte:A,$ne:x,$add:O,$subtract:b,$divide:D,$multiply:w,$mod:j,$concat:_,$substr:E,$toLower:M,$toUpper:T,$strcasecmp:q,$meta:P,$dayOfYear:S,$dayOfMonth:U,$dayOfWeek:k,$year:C,$month:N,$week:z,$hour:L,$minute:F,$second:Y,$millisecond:I,$dateToString:R},e.exports=t["default"]},{lodash:void 0}],6:[function(r,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("./aggregation"),u=r("./count"),i=r("./expressions"),o={aggregate:n.aggregate,count:u.count,$expression:i.$expression,$group:n.$group,$project:n.$project};t["default"]=o,e.exports=t["default"]},{"./aggregation":2,"./count":3,"./expressions":4}]},{},[6]);