!function r(e,t,n){function u(o,a){if(!t[o]){if(!e[o]){var s="function"==typeof require&&require;if(!a&&s)return s(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var c=t[o]={exports:{}};e[o][0].call(c.exports,function(r){var t=e[o][1][r];return u(t?t:r)},c,c.exports,r,e,t,n)}return t[o].exports}for(var i="function"==typeof require&&require,o=0;o<n.length;o++)u(n[o]);return u}({1:[function(r,e,t){"use strict";function n(r){return 1===p.size(r)&&p.keys(r)[0]in y}function u(r,e){if(n(e)){var t=p.keys(e)[0],u=e[t],i=y[t],o=i(r,u);return o}}function i(r,e){return 1===e?p.size(r):p.sum(r,function(r){return d.$expression(r,e)})}function o(r,e){return i(r,e)/p.size(r)}function a(r,e){return d.$expression(p.first(r),e)}function s(r,e){return d.$expression(p.last(r),e)}function f(r,e){return p.max(r,function(r){return d.$expression(r,e)})}function c(r,e){return p.min(r,function(r){return d.$expression(r,e)})}function l(r,e){return p.map(r,function(r){return d.$expression(r,e)})}function g(r,e){return console.debug("Please find a more efficient way to do this"),p.unique(l(r,e),function(r){return JSON.stringify(r)})}Object.defineProperty(t,"__esModule",{value:!0});var p=r("lodash"),d=r("./expressions"),y={$accumulate:u,$sum:i,$avg:o,$first:a,$last:s,$min:c,$max:f,$push:l,$addToSet:g};t["default"]=y,t.$accumulate=u},{"./expressions":4,lodash:void 0}],2:[function(r,e,t){"use strict";function n(r,e){return"_id"in e||(e._id=1),o.chain(r).map(function(r){return a.$expressionObject(r,e,r)})}function u(r){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],t=e._id,n=o.chain(r).groupBy(function(r){return t?JSON.stringify(a.$expression(r,t)):null});return n.map(function(r,n,u){return o.mapValues(e,function(e,n){return"_id"===n?e?a.$expression(r[0],t):null:s.$accumulate(r,e)})})}function i(r,e){o.isArray(e)||(e=[e]),r=o.chain(r);for(var t=0;t<e.length;t++){var i=e[t];i.$project&&(r=n(r,i.$project)),i.$group&&(r=u(r,i.$group))}return r.value()}Object.defineProperty(t,"__esModule",{value:!0});var o=r("lodash"),a=r("./expressions"),s=r("./accumulators");t["default"]={aggregate:i,$project:n,$group:u},e.exports=t["default"]},{"./accumulators":1,"./expressions":4,lodash:void 0}],3:[function(r,e,t){"use strict";function n(r){return u.size(r)}Object.defineProperty(t,"__esModule",{value:!0});var u=r("lodash");t["default"]={count:n},e.exports=t["default"]},{lodash:void 0}],4:[function(r,e,t){"use strict";function n(r){return r&&r.__esModule?r:{"default":r}}function u(r){if(Array.isArray(r)){for(var e=0,t=Array(r.length);e<r.length;e++)t[e]=r[e];return t}return Array.from(r)}function i(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function o(r){return"string"==typeof r&&0===r.indexOf("$")&&-1===r.indexOf("$$")}function a(r){return"string"==typeof r&&0===r.indexOf("$$")}function s(r){return $.isObject(r)&&!f(r)&&!$.isArray(r)&&!$.isDate(r)}function f(r){return 1===$.size(r)&&$.keys(r)[0]in m["default"]}function c(r,e,t){var n;return void 0===t&&(t=r),n=a(e)?d(r,e,t):f(e)?g(t,e,t):o(e)?l(r,e):s(e)?p(r,e,t):e}function l(r,e){return e=e.slice(1),$.get(r,e)}function g(r,e,t){var n,i=$.keys(e)[0],o=e[i],a=m["default"][i];return $.isArray(o)||(o=[o]),o=o.map(function(e){return c(r,e,t)}),n=a.apply(void 0,u(o))}function p(r,e,t){var n={};void 0===t&&(t=r);var u=function(u){var o=t,s=e[u];if(-1!==u.indexOf(".")){a=u.split(".");var f=a.shift(),l=$.get(r,f);$.isArray(l)?$.set(n,f,l.map(function(r){return c(r,i({},a.join("."),s),t)})):$.merge(n,$.set({},f,c(l,i({},a.join("."),s),t)))}else{if(s===!0||1===s)o=r,s="$"+u;else{if(s===!1||0===s)return"continue";"string"==typeof s?o=t:"object"==typeof s&&(o=$.get(r,u))}$.isArray(o)?$.merge(n,$.set({},u,o.map(function(r){return c(r,s,t)}))):$.merge(n,$.set({},u,c(o,s,t)))}};for(var o in e)var a,s=u(o);return n}function d(r,e,t){switch(e){case"$$ROOT":return t;case"$$CURRENT":return r}throw Error("Unsupported system variable")}function y(){}Object.defineProperty(t,"__esModule",{value:!0});var $=r("lodash"),v=r("./operators"),m=n(v);t["default"]={$expression:c,$fieldPath:l,$systemVariable:d,$literal:y,$expressionObject:p,isExpressionOperator:f,isExpressionObject:s},e.exports=t["default"]},{"./operators":5,lodash:void 0}],5:[function(r,e,t){"use strict";function n(r){if(Array.isArray(r)){for(var e=0,t=Array(r.length);e<r.length;e++)t[e]=r[e];return t}return Array.from(r)}function u(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return Y.every(e)}function i(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return Y.some(e)}function o(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return!Y.some(e)}function a(r){return Y.unique(r).sort(y)}function s(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];var n=e.map(a),u=n.shift();return Y.every(n,Y.partial(Y.isEqual,u))}function f(){return a(Y.intersection.apply(void 0,arguments))}function c(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return Y.union.apply(void 0,n(e.map(a)))}function l(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];return Y.difference.apply(void 0,n(e.map(a)))}function g(r,e){return Y.isEqual(a(Y.intersection(r,e)),a(r))}function p(r){if(!Y.isArray(r))throw Error("values must be an array, got "+typeof r);return i.apply(void 0,n(r))}function d(r){if(!Y.isArray(r))throw Error("values must be an array, got "+typeof r);return u.apply(void 0,n(r))}function y(r,e){return Y.isArray(r)&&Y.isArray(e)?0:h(r,e)?-1:v(r,e)?1:0}function $(r,e){return Y.isEqual(r,e)}function v(r,e){return Y.isArray(e)&&!Y.isArray(r)?!1:Y.isArray(r)&&!Y.isArray(e)?!0:Y.gt(r,e)}function m(r,e){return Y.isArray(e)&&!Y.isArray(r)?!1:Y.isArray(r)&&!Y.isArray(e)?!0:Y.gte(r,e)}function h(r,e){return Y.isArray(e)&&!Y.isArray(r)?!0:Y.isArray(r)&&!Y.isArray(e)?!1:Y.lt(r,e)}function A(r,e){return Y.isArray(e)&&!Y.isArray(r)?!0:Y.isArray(r)&&!Y.isArray(e)?!1:Y.lte(r,e)}function x(r,e){return!$(r,e)}function O(){for(var r=arguments.length,e=Array(r),t=0;r>t;t++)e[t]=arguments[t];var n=e.shift(),u=!1;Y.isDate(n)&&(u=!0,n=n.getTime());for(var i=e.length-1;i>=0;i--){var o=e[i];Y.isDate(o)&&(u=!0,o=o.getTime()),n+=o}return u?new Date(n):n}function b(r,e){return Y.isDate(r)&&Y.isDate(e)?r.getTime()-e.getTime():Y.isDate(r)&&!Y.isDate(e)?new Date(r.getTime()-e):!Y.isDate(r)&&Y.isDate(e)?new Date(r-e.getTime()):r-e}function D(r,e){return r*e}function _(r,e){return r/e}function j(r,e){return r%e}function w(r,e,t){return r.slice(e,e+t)}function E(r){var e=new Date(r.getFullYear(),0,0),t=r-e,n=864e5,u=Math.floor(t/n);return u}function M(r){return r?r.getDate():null}function T(r){return r?r.getDay():null}function q(r){return r?r.getFullYear():null}function P(r){return r?r.getMonth()+1:null}function S(r){var e=new Date(r.valueOf()),t=(r.getDay()+6)%7;e.setDate(e.getDate()-t+3);var n=new Date(e.getFullYear(),0,4),u=(e-n)/864e5,i=1+Math.ceil(u/7);return i}function k(r){return r.getHours()}function z(r){return r.getMinutes()}function N(r){return r.getSeconds()}function U(r){return r.getMilliseconds()}function F(r){return r.toString()}Object.defineProperty(t,"__esModule",{value:!0});var Y=r("lodash");t["default"]={$and:u,$or:i,$not:o,$setEquals:s,$setIntersection:f,$setUnion:c,$setDifference:l,$setIsSubset:g,$anyElementTrue:p,$allElementsTrue:d,$cmp:y,$eq:$,$gt:v,$gte:m,$lt:h,$lte:A,$ne:x,$add:O,$subtract:b,$divide:_,$multiply:D,$mod:j,$substr:w,$dayOfYear:E,$dayOfMonth:M,$dayOfWeek:T,$year:q,$month:P,$week:S,$hour:k,$minute:z,$second:N,$millisecond:U,$dateToString:F},e.exports=t["default"]},{lodash:void 0}],6:[function(r,e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("./aggregation"),u=r("./count"),i=r("./expressions"),o={aggregate:n.aggregate,count:u.count,$expression:i.$expression,$group:n.$group,$project:n.$project};t["default"]=o,e.exports=t["default"]},{"./aggregation":2,"./count":3,"./expressions":4}]},{},[6]);